!function(t){function e(e){for(var r,h,o=e[0],s=e[1],u=e[2],c=0,f=[];c<o.length;c++)h=o[c],n[h]&&f.push(n[h][0]),n[h]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);for(l&&l(e);f.length;)f.shift()();return a.push.apply(a,u||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],r=!0,o=1;o<i.length;o++){var s=i[o];0!==n[s]&&(r=!1)}r&&(a.splice(e--,1),t=h(h.s=i[0]))}return t}var r={},n={0:0},a=[];function h(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,h),i.l=!0,i.exports}h.m=t,h.c=r,h.d=function(t,e,i){h.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},h.t=function(t,e){if(1&e&&(t=h(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(h.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)h.d(i,r,function(e){return t[e]}.bind(null,r));return i},h.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return h.d(e,"a",e),e},h.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},h.p="";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=s;a.push([5,1]),i()}({0:function(t,e,i){var r;!function(){"use strict";var e=1/1048576;function i(t,i,r,n){var a,h,o,s,u,l,c,f,d,p,g=t[i][0],v=t[i][1],w=t[r][0],m=t[r][1],b=t[n][0],I=t[n][1],y=Math.abs(v-m),x=Math.abs(m-I);if(y<e&&x<e)throw new Error("Eek! Coincident points!");return y<e?h=(s=-(b-w)/(I-m))*((a=(w+g)/2)-(l=(w+b)/2))+(f=(m+I)/2):x<e?h=(o=-(w-g)/(m-v))*((a=(b+w)/2)-(u=(g+w)/2))+(c=(v+m)/2):(a=((o=-(w-g)/(m-v))*(u=(g+w)/2)-(s=-(b-w)/(I-m))*(l=(w+b)/2)+(f=(m+I)/2)-(c=(v+m)/2))/(o-s),h=y>x?o*(a-u)+c:s*(a-l)+f),{i:i,j:r,k:n,x:a,y:h,r:(d=w-a)*d+(p=m-h)*p}}function n(t){var e,i,r,n,a,h;for(i=t.length;i;)for(n=t[--i],r=t[--i],e=i;e;)if(h=t[--e],r===(a=t[--e])&&n===h||r===h&&n===a){t.splice(i,2),t.splice(e,2);break}}r={triangulate:function(t,r){var a,h,o,s,u,l,c,f,d,p,g,v,w=t.length;if(w<3)return[];if(t=t.slice(0),r)for(a=w;a--;)t[a]=t[a][r];for(o=new Array(w),a=w;a--;)o[a]=a;for(o.sort(function(e,i){var r=t[i][0]-t[e][0];return 0!==r?r:e-i}),s=function(t){var e,i,r,n,a,h,o=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(e=t.length;e--;)t[e][0]<o&&(o=t[e][0]),t[e][0]>u&&(u=t[e][0]),t[e][1]<s&&(s=t[e][1]),t[e][1]>l&&(l=t[e][1]);return r=l-s,[[(a=o+.5*(i=u-o))-20*(n=Math.max(i,r)),(h=s+.5*r)-n],[a,h+20*n],[a+20*n,h-n]]}(t),t.push(s[0],s[1],s[2]),u=[i(t,w+0,w+1,w+2)],l=[],c=[],a=o.length;a--;c.length=0){for(v=o[a],h=u.length;h--;)(f=t[v][0]-u[h].x)>0&&f*f>u[h].r?(l.push(u[h]),u.splice(h,1)):f*f+(d=t[v][1]-u[h].y)*d-u[h].r>e||(c.push(u[h].i,u[h].j,u[h].j,u[h].k,u[h].k,u[h].i),u.splice(h,1));for(n(c),h=c.length;h;)g=c[--h],p=c[--h],u.push(i(t,p,g,v))}for(a=u.length;a--;)l.push(u[a]);for(u.length=0,a=l.length;a--;)l[a].i<w&&l[a].j<w&&l[a].k<w&&u.push(l[a].i,l[a].j,l[a].k);return u},contains:function(t,e){if(e[0]<t[0][0]&&e[0]<t[1][0]&&e[0]<t[2][0]||e[0]>t[0][0]&&e[0]>t[1][0]&&e[0]>t[2][0]||e[1]<t[0][1]&&e[1]<t[1][1]&&e[1]<t[2][1]||e[1]>t[0][1]&&e[1]>t[1][1]&&e[1]>t[2][1])return null;var i=t[1][0]-t[0][0],r=t[2][0]-t[0][0],n=t[1][1]-t[0][1],a=t[2][1]-t[0][1],h=i*a-r*n;if(0===h)return null;var o=(a*(e[0]-t[0][0])-r*(e[1]-t[0][1]))/h,s=(i*(e[1]-t[0][1])-n*(e[0]-t[0][0]))/h;return o<0||s<0||o+s>1?null:[o,s]}},t.exports=r}()},5:function(t,e,i){"use strict";i.r(e);i(1),i(3);var r=i(0),n=i.n(r);const a=[[-1,0,1],[-2,0,2],[-1,0,1]],h=[[-1,-2,-1],[0,0,0],[1,2,1]];var o,s,u,l={trans:function(t,e,i){o=t,s=e,u=i;for(var r=new Uint8ClampedArray(s*u),n=0;n<u;n++)for(var a=0;a<s;a++){let t=f(a,n);r[n*s+a]=t}return r}};function c(t,e){return t<0&&(t=0),e<0&&(e=0),t>=s&&(t=s-1),e>=u&&(e=u-1),o[e*s+t]}function f(t,e){let i=a[0][0]*c(t-1,e-1)+a[0][1]*c(t-1,e)+a[0][2]*c(t-1,e+1)+a[1][0]*c(t,e-1)+a[1][1]*c(t,e)+a[1][2]*c(t,e+1)+a[2][0]*c(t+1,e-1)+a[2][1]*c(t+1,e)+a[2][2]*c(t+1,e+1),r=h[0][0]*c(t-1,e-1)+h[0][1]*c(t-1,e)+h[0][2]*c(t-1,e+1)+h[1][0]*c(t,e-1)+h[1][1]*c(t,e)+h[1][2]*c(t,e+1)+h[2][0]*c(t+1,e-1)+h[2][1]*c(t+1,e)+h[2][2]*c(t+1,e+1);return Math.sqrt(i*i+r*r)>>0}var d=document.getElementById("canvas");d.width=window.innerWidth,d.height=window.innerHeight;var p,g=new FileReader,v=new Image;v.src="./src/rose.jpg";var w=function(){d.width=window.innerWidth,d.height=window.innerHeight,p.resize()};window.onresize=function(){clearTimeout(w.tid),w.tid=setTimeout(function(){w()},300)},g.onload=function(t){v.src=t.target.result},v.onload=function(){p=new class{constructor(t,e,i){this.image=t,this.canvas=e,this.ctx=e.getContext("2d"),this.getImageData(),this.getSobelData(),this.render()}resize(){this.getImageData(),this.getSobelData(),this.render()}getImageData(){let t=this.canvas.width,e=this.canvas.height,i=this.image.naturalWidth,r=this.image.naturalHeight,n=Math.min(t/i,e/r);this.width=Math.floor(i*n),this.height=Math.floor(r*n),this.posX=Math.floor(t-this.width)/2,this.posY=Math.floor(e-this.height)/2,this.ctx.clearRect(0,0,t,e),this.ctx.drawImage(this.image,this.posX,this.posY,this.width,this.height),this.inputData=this.ctx.getImageData(this.posX,this.posY,this.width,this.height).data}getSobelData(){let t=this.width*this.height*4,e=new Uint8ClampedArray(t);for(var i=0;i<t;i+=4){let t=Math.round(.299*this.inputData[i]+.587*this.inputData[i+1]+.114*this.inputData[i+2]);e[i/4]=t}this.sobelData=l.trans(e,this.width,this.height)}getVertices(){for(var t=[[0,0],[this.width,0],[0,this.height],[this.width,this.height]],e=0;e<this.height;e++)for(var i=0;i<this.width;i++){let r=this.width*e+i,n=this.sobelData[r];n>200?Math.random()>.95&&t.push([i,e]):n>100?Math.random()>.98&&t.push([i,e]):n>40?Math.random()>.98&&t.push([i,e]):Math.random()>.999&&t.push([i,e])}return t}render(){var t=this.getVertices();console.log("vertices",t.length);for(var e=n.a.triangulate(t),i=0;i<e.length;i+=3){let n=e[i],a=e[i+1],h=e[i+2];this.ctx.beginPath(),this.ctx.moveTo(t[n][0]+this.posX,t[n][1]+this.posY),this.ctx.lineTo(t[a][0]+this.posX,t[a][1]+this.posY),this.ctx.lineTo(t[h][0]+this.posX,t[h][1]+this.posY),this.ctx.closePath();let o=[Math.floor((t[n][0]+t[a][0]+t[h][0])/3),Math.floor((t[n][1]+t[a][1]+t[h][1])/3)];var r=4*(o[1]*this.width+o[0]);this.ctx.fillStyle=`rgba(${this.inputData[r]}, ${this.inputData[r+1]}, ${this.inputData[r+2]}, ${this.inputData[r+3]}`,this.ctx.fill()}}}(v,d)};var m="picture";document.getElementById("file").onchange=function(t){this.files[0]&&(m=this.files[0].name,g.readAsDataURL(this.files[0]))};var b=document.createElement("a");document.getElementById("download").onclick=function(){let t=d.toDataURL();b.setAttribute("href",t),b.setAttribute("download",m),b.click()}}});